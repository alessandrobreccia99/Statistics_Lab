library(tidyverse)
df_amer_air <- read.delim(file='/Users/alessandrobreccia/Desktop/1_ANNO_MAGISTR/2_semester/AdvStat/Lab/Rlab01/american_airline_empl.txt', header=TRUE, dec=",")
df_delta_air <- read.delim(file='/Users/alessandrobreccia/Desktop/1_ANNO_MAGISTR/2_semester/AdvStat/Lab/Rlab01/delta_airline_empl.txt', header=TRUE,dec=",")
df_federal_express_air <- read.delim(file='/Users/alessandrobreccia/Desktop/1_ANNO_MAGISTR/2_semester/AdvStat/Lab/Rlab01/federal_express_empl.txt', header=TRUE,dec=",")
df_united_airline_empl <- read.delim(file='/Users/alessandrobreccia/Desktop/1_ANNO_MAGISTR/2_semester/AdvStat/Lab/Rlab01/united_airline_empl.txt', header=TRUE,dec=",")
df_delta_air
df_amer_air <- df_amer_air %>% add_column(comp="amer_air")
df_delta_air <- df_delta_air %>% add_column(comp="delta_air")
df_federal_express_air <- df_federal_express_air %>% add_column(comp="federal_express_air")
df_united_airline_empl <- df_united_airline_empl %>% add_column(comp="united_airline_empl")
df_tot <- full_join(df_amer_air,(full_join(df_delta_air,full_join(df_federal_express_air,df_united_airline_empl))))
print(df_tot)
df_tot$date <- as.Date(with(df_tot, paste(Year, Month,1,sep="-")), "%Y-%m-%d")
print(df_tot)
library(tidyverse)
ggplot(data = df_tot, mapping = aes(x = date, y = Full.time)) +
geom_point(aes(color = comp)) + geom_line(aes(color = comp))
ggplot(data = df_tot, mapping = aes(x = date, y = Part.time)) +
geom_point(aes(color = comp)) + ylim(0,100) + geom_line(aes(color = comp))
maxemplame <- which.max(df_amer_air$Grand.Total)
minemplame <- which.min(df_amer_air$Grand.Total)
print(df_tot[maxemplame,])
print(df_tot[minemplame,])
maxempldel <- which.max(df_delta_air$Grand.Total)
minempldel <- which.min(df_delta_air$Grand.Total)
print(df_tot[maxempldel,])
print(df_tot[minempldel,])
maxempluni <- which.max(df_united_airline_empl$Grand.Total)
minempluni <- which.min(df_united_airline_empl$Grand.Total)
print(df_tot[maxemplame,])
print(df_tot[minemplame,])
maxemplfed <- which.max(df_federal_express_air$Grand.Total)
minemplfed <- which.min(df_federal_express_air$Grand.Total)
print(df_tot[maxemplfed,])
print(df_tot[minemplfed,])
ggplot(data = df_tot, mapping = aes(x = date, y = Part.time/Grand.Total)) +
geom_point(aes(color = comp)) + geom_line(aes(color = comp))
ggplot(data = df_tot, mapping = aes(x = date, y = Full.time/Grand.Total)) +
geom_point(aes(color = comp)) + ylim(0,1) + geom_line(aes(color = comp))
library(nycflights13)
library(tidyverse)
print(airlines)
print(airports)
print(flights)
print(planes)
flights$date <- as.Date(with(flights, paste(year, month,day,sep="-")), "%Y-%m-%d")
print(flights)
library(dplyr)
flights$wdate <- weekdays(as.Date(flights$date))
totflight <- flights %>%  group_by(date,origin,wdate) %>% summarise(count=n(),.groups = 'drop')
print(totflight)
ggplot(data = totflight, mapping = aes(x = date, y = count)) +
geom_point(aes(color = origin))
totflight$week <- strftime(totflight$date, format = "%V")
print(totflight)
avgweekend <- totflight[ totflight$wdate == 'Saturday' | totflight$wdate == 'Sunday' , ] %>%  group_by(week) %>% summarise(mean=mean(count),.groups='drop')
avgweek <- totflight[ totflight$wdate == 'Monday' | totflight$wdate == 'Tuesday'  | totflight$wdate == 'Wednesday'  | totflight$wdate == 'Thursday'  | totflight$wdate == 'Friday' ,] %>%  group_by(week) %>% summarise(mean=mean(count),.groups='drop')
avgweekend <- avgweekend %>% add_column(id='week-end')
avgweek <- avgweek %>% add_column(id='week')
avg= rbind(avgweekend,avgweek)
ggplot(data = avg, mapping = aes(x = week, y = mean)) +
geom_point(aes(color = id)) + geom_line(aes(color = id))
library(ggplot2)
library(reshape2)
maxdel <- flights %>%  group_by(date) %>% summarise(max=max(dep_delay, na.rm=TRUE), min=min(dep_delay, na.rm=TRUE), avg=mean(dep_delay, na.rm=TRUE))
maxdel <- melt(maxdel ,  id.vars = 'date', variable.name = 'type')
ggplot(data = maxdel, mapping = aes(x = date, y = value)) + geom_line(aes(color = type))
flights$speed <- flights$distance/((flights$air_time %/% 100) + (flights$air_time %% 100)/60)
print(flights)
avgspeed <- flights %>%  group_by(date,origin) %>% summarise(avg=mean(speed, na.rm=TRUE), .groups='drop')
print(avgspeed)
ggplot(data = avgspeed, mapping = aes(x = date, y = avg)) + geom_point(aes(color= origin))
print(flights)
perweek <- flights %>%  group_by(week,carrier) %>% summarise(avg=n(), .groups='drop')
flights$week <- strftime(flights$date, format = "%V")
perweek <- flights %>%  group_by(week,carrier) %>% summarise(avg=n(), .groups='drop')
print(perweek)
perweek <- flights %>%  group_by(date,carrier) %>% summarise(avg=n(), .groups='drop')
print(perweek)
perday <- flights %>%  group_by(date,carrier) %>% summarise(numb=n(), .groups='drop')
print(max(perweek$numb))
flights$week <- strftime(flights$date, format = "%V")
print(max(perweek$numb))
print(max(perday$numb))
print(perday[which.max(perday$numb)],)
print(perday[which.max(perday$numb)])
print(perday[which.max(perday$numb),])
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
print(perday[which.max(perweek$numb),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(numb=n(), .groups='drop')
print(perday[which.max(perday$numb),])
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
print(perday[which.max(perweek$numb),])
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
print(perweek)
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
print(perweek)
print(perweek[which.max(perweek$numb),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(numb=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
print(perday[which.max(perday$numb),])
print(perweek[which.max(perweek$numb),])
print(permonth[which.min(permonth$numb),])
permonth <- flights %>%  group_by(month,carrier) %>% summarise(numb=n(), .groups='drop')
print(permonth[which.min(permonth$numb),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(numb=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
permonth <- flights %>%  group_by(month,carrier) %>% summarise(numb=n(), .groups='drop')
print(perday[which.max(perday$numb),])
print(perweek[which.max(perweek$numb),])
print(permonth[which.min(permonth$numb),])
permonth <- flights %>%  group_by(month,carrier) %>% summarise(numb=max(distance, na.rm=TRUE), .groups='drop')
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(numb=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(numb=n(), .groups='drop')
permonth <- flights %>%  group_by(month,carrier) %>% summarise(numb=n(), .groups='drop')
distpermoth <- flights %>%  group_by(month,carrier) %>% summarise(numb=max(distance, na.rm=TRUE), .groups='drop')
print(perday[which.max(perday$numb),])
print(perweek[which.max(perweek$numb),])
print(permonth[which.min(permonth$numb),])
print(distpermoth[which.max(distpermoth$numb),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(flights_per_day=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(flights_per_week=n(), .groups='drop')
permonth <- flights %>%  group_by(month,carrier) %>% summarise(flights_per_month=n(), .groups='drop')
distpermoth <- flights %>%  group_by(month,carrier) %>% summarise(dist=max(distance, na.rm=TRUE), .groups='drop')
print(perday[which.max(perday$numb),])
print(perweek[which.max(perweek$numb),])
print(permonth[which.min(permonth$numb),])
print(distpermoth[which.max(distpermoth$numb),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(flights_per_day=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(flights_per_week=n(), .groups='drop')
permonth <- flights %>%  group_by(month,carrier) %>% summarise(flights_per_month=n(), .groups='drop')
distpermoth <- flights %>%  group_by(month,carrier) %>% summarise(dist=max(distance, na.rm=TRUE), .groups='drop')
print(perday[which.max(perday$flights_per_day),])
print(perweek[which.max(perweek$flights_per_week),])
print(permonth[which.min(permonth$flights_per_month),])
print(distpermoth[which.max(distpermoth$dist),])
print(permonth[which.max(permonth$flights_per_month),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(flights_per_day=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(flights_per_week=n(), .groups='drop')
permonth <- flights %>%  group_by(month,carrier) %>% summarise(flights_per_month=n(), .groups='drop')
distpermoth <- flights %>%  group_by(month,carrier) %>% summarise(dist=max(distance, na.rm=TRUE), .groups='drop')
print(perday[which.max(perday$flights_per_day),])
print(perweek[which.max(perweek$flights_per_week),])
print(permonth[which.max(permonth$flights_per_month),])
print(distpermoth[which.max(distpermoth$dist),])
flights$week <- strftime(flights$date, format = "%V")
perday <- flights %>%  group_by(date,carrier) %>% summarise(flights_per_day=n(), .groups='drop')
perweek <- flights %>%  group_by(week,carrier) %>% summarise(flights_per_week=n(), .groups='drop')
permonth <- flights %>%  group_by(month,carrier) %>% summarise(flights_per_month=n(), .groups='drop')
distpermoth <- flights %>%  group_by(month,carrier) %>% summarise(dist=max(distance, na.rm=TRUE), .groups='drop')
print(perday[which.max(perday$flights_per_day),])
print(perweek[which.max(perweek$flights_per_week),])
print(permonth[which.min(permonth$flights_per_month),])
print(distpermoth[which.max(distpermoth$dist),])
